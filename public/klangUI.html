<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Klang 模块式程序设计</title>
<link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <script src="/js/blockly_compressed.js"></script>
  <script src="/js/blocks_compressed.js"></script>
  <script src="/js/python_compressed.js"></script>
  <script src="/js/msg/zh-hans.js"></script>
  <script src="/js/klang.js"></script>
    <style>
    body {
      background-color: #fff;
      font-family: sans-serif;
    }
    h1 {
      font-weight: normal;
      font-size: 140%;
    }
  </style>
</head>
<body>
<div class="container">
 <nav>
 <div class="nav nav-tabs" id="nav-tab" role="tablist">
 <button class="nav-link active" id="nav-home-tab" data-bs-toggle="tab" data-bs-target="#nav-home" type="button" role="tab" aria-controls="nav-home" aria-selected="true">选择策略</button>
 <button class="nav-link" id="nav-code-tab" data-bs-toggle="tab" data-bs-target="#nav-code" type="button" role="tab" aria-controls="nav-code" aria-selected="false">查看代码</button>
 </div>
 </nav>
 <div class="tab-content" id="nav-tabContent">
 <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab">

 <div id="blocklyDiv" style="height: 480px; width: 600px;"></div>
 <xml id="toolbox" style="display: none;">

    <category name="常用函数" colour="%{BKY_LOGIC_HUE}">
        <block type="math_number"></block>
    </category>

    <category name="其他功能" colour="%{BKY_MATH_HUE}">
        <block type="controls_if"></block>
        <block type="logic_compare"></block>
        <block type="variables_get"></block>
        <block type="variables_set"></block>
        <block type="math_number"></block>
        <block type="macd"></block>
    </category>
    <category name="变量参数" colour="%{BKY_VARIABLES_HUE}" custom="VARIABLE"></category>
    <category name="公式" colour="%{BKY_PROCEDURES_HUE}" custom="PROCEDURE"></category>
 </xml>


 </div>

 <div class="tab-pane fade" id="nav-code" role="tabpanel" aria-labelledby="nav-profile-tab">/*快点选择策略吧,祝您大涨*/</div>
 </div>


</div> <!--class="container"-->

   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
   <script src="https://cdn.bootcdn.net/ajax/libs/vue/3.1.0/vue.global.js"></script>
   <script src="https://cdn.bootcdn.net/ajax/libs/axios/0.21.1/axios.min.js"></script>

   <script>

     var blocklyDiv = document.getElementById('blocklyDiv');
     var codetab = document.getElementById('nav-code-tab');
     var navcode = document.getElementById('nav-code');
     var workspace = Blockly.inject(blocklyDiv, {
           media:'/img/',
           toolbox: document.getElementById('toolbox'),  // 定义ToolBox
    });

    function updateKlang(event){
        var pycode = Blockly.Python.workspaceToCode(workspace)
        navcode.innerText = pycode
    }
    workspace.addChangeListener(updateKlang)
   </script>
</body>
</html>
